% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_cwdata.R
\name{sim.cwdata}
\alias{sim.cwdata}
\title{Simulate Survey Data and Compute Bias-Corrected Estimates}
\usage{
sim.cwdata(N.sim = 500, sample, pi, p, p.prime, gamma, direct)
}
\arguments{
\item{N.sim}{Integer. Number of Monte Carlo simulations to run. Default is 500.}

\item{sample}{Integer. Sample size per simulation (number of respondents).}

\item{pi}{Numeric. True prevalence rate of the sensitive attribute (between 0 and 1).}

\item{p}{Numeric. Probability for the randomization item in sensitive question (between 0 and 1).}

\item{p.prime}{Numeric. Probability for the anchor question (non-sensitive, between 0 and 1).}

\item{gamma}{Numeric. Proportion of attentive respondents (between 0 and 1).}

\item{direct}{Numeric. Direct questioning estimate for comparison purposes (between 0 and 1).}
}
\value{
A list containing:
\describe{
  \item{Results}{Named vector with summary statistics including average bias,
                 RMSE, and coverage rates for both naive and bias-corrected estimators}
  \item{BiasCorrectEst}{Numeric vector of bias-corrected point estimates (sorted)}
  \item{BiasCorrectLow}{Numeric vector of lower bounds of 95\% bootstrap CIs (sorted)}
  \item{BiasCorrectHigh}{Numeric vector of upper bounds of 95\% bootstrap CIs (sorted)}
  \item{EstimatedBias}{Numeric vector of estimated bias values for each simulation}
  \item{RelativeLengthCI}{Numeric vector of relative CI lengths (bias-corrected vs naive)}
}
}
\description{
Core simulation function that generates crosswise model data with inattentive
respondents and computes bias-corrected prevalence estimates with bootstrap
confidence intervals. This implements the methodology described in Appendix C5
for power analysis of the crosswise model.
}
\details{
The function implements the crosswise model with bias correction for inattentive
respondents. For each simulation:
\itemize{
  \item Generates attentive/inattentive status based on gamma
  \item Simulates responses to sensitive question (crosswise format)
  \item Simulates responses to anchor question (for estimating attention rate)
  \item Computes naive crosswise estimate
  \item Applies bias correction based on estimated inattention
  \item Uses bootstrap (500 iterations) to compute 95\% confidence intervals
}

The bias correction formula is:
\deqn{\hat{\pi}_{BC} = \hat{\pi}_{naive} - \hat{Bias}}
where the bias is estimated using the anchor question responses.
}
\examples{
# Basic usage
result <- sim.cwdata(
  N.sim = 100,
  sample = 500,
  pi = 0.1,
  p = 0.1,
  p.prime = 0.1,
  gamma = 0.8,
  direct = 0.05
)
print(result$Results)

}
\references{
Atsusaka and Stevenson (2021). Appendix C5: Sample Size Determination
and Parameter Selection.
}
